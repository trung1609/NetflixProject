<div class="video-list-container">
  <div class="header-section">
    <div class="title-wrapper">
      <h1 class="page-title">
        Video Library
      </h1>
      <p class="page-subtitle">Manage and organize your video content</p>
    </div>

    <div class="header-actions">
      <button mat-raised-button color="accent" (click)="createNew()" class="upload-btn">
        <mat-icon>add_circle</mat-icon>
        Upload New Video
      </button>

      <button mat-icon-button (click)="load()" [disabled]="loading" class="refresh-btn" title="Refresh">
        <mat-icon>refresh</mat-icon>
      </button>
    </div>
  </div>

  <div class="search-section">
    <div class="search-wrapper">
      <mat-icon class="search-icon">search</mat-icon>
      <input type="text" class="search-input" placeholder="Search by title or description" [(ngModel)]="searchQuery"
        (input)="onSearchChange($event)">
      <button mat-icon-button *ngIf="searchQuery" class="clear-btn" (click)="clearSearch()">
        <mat-icon>close</mat-icon>
      </button>
    </div>

    <div class="search-info">
      <span *ngIf="!loading">Showing {{pagedVideos.length}} of {{totalElements}} Videos</span>
    </div>
  </div>

  <mat-progress-bar *ngIf="loading" mode="indeterminate" class="loading-bar"></mat-progress-bar>

  <div class="stats-row" *ngIf="!loading && pagedVideos.length > 0">
    <div class="stat-card">
      <mat-icon>video_library</mat-icon>
      <div class="stat-content">
        <span class="stat-value">{{totalVideos}}</span>
        <span class="stat-label">Total Videos</span>
      </div>
    </div>

    <div class="stat-card">
      <mat-icon>publish</mat-icon>
      <div class="stat-content">
        <span class="stat-value">{{getPublishedCount()}}</span>
        <span class="stat-label">Published Videos</span>
      </div>
    </div>

    <div class="stat-card">
      <mat-icon>schedule</mat-icon>
      <div class="stat-content">
        <span class="stat-value">{{getTotalDuration()}}</span>
        <span class="stat-label">Total Duration</span>
      </div>
    </div>
  </div>

  <div class="video-grid" *ngIf="!loading && pagedVideos.length > 0">
    <div class="video-card" *ngFor="let v of pagedVideos">
      <div class="card-thumbnail" (click)="play(v)">
        <img [src]="getPosterUrl(v)" [alt]="v.title" class="thumbnail-img">
        <div class="thumbnail-overlay">
          <mat-icon class="play-icon">play_circle</mat-icon>
        </div>
        <div class="duration-badge" *ngIf="v.duration">{{formatDuration(v.duration)}}</div>
        <div class="status-badge" [class.published]="v.published" [class.draft]="!v.published">
          {{v.published ? 'Published' : 'Draft'}}
        </div>
      </div>

      <div class="card-content">
        <h3 class="card-title" (click)="edit(v)">{{v.title}}</h3>
        <p class="card-description">{{v.description || 'No description'}}</p>

        <div class="card-meta">
          <div class="meta-item" *ngIf="v.year">
            <mat-icon>calendar_today</mat-icon>
            <span>{{v.year}}</span>
          </div>

          <div class="meta-item" *ngIf="v.rating">
            <mat-icon>star</mat-icon>
            <span>{{v.rating}}</span>
          </div>
          
          <div class="meta-item categories" *ngIf="v.categories && v.categories.length > 0">
            <mat-icon>category</mat-icon>
            <span>{{v.categories.join(', ')}}</span>
          </div>
        </div>

        <div class="card-actions">
          <button mat-button class="action-btn" (click)="edit(v)">
            <mat-icon>edit</mat-icon>
            Edit
          </button>

          <button mat-button class="action-btn danger" (click)="remove(v)">
            <mat-icon>delete</mat-icon>
            Delete
          </button>

          <mat-slide-toggle color="primary" [checked]="v.published" (change)="togglePublish($event, v)"
            class="publish-toggle">

          </mat-slide-toggle>
        </div>
      </div>
    </div>
  </div>


  <div class="load-more-container">
    <div class="loading-more" *ngIf="loadingMore">
      <mat-spinner diameter="40"></mat-spinner>
      <p>Loading more videos...</p>
    </div>
    <div class="end-of-content" *ngIf="!loadingMore && !hasMoreVideos && pagedVideos.length > 0">
      <mat-icon>check_circle</mat-icon>
      <p>You've reached the end of the videos list.</p>
    </div>
  </div>

  <div class="empty-state" *ngIf="!loading && pagedVideos.length === 0 && !searchQuery">
    <mat-icon class="empty-icon">video_library</mat-icon>
    <h2>No videos yet</h2>
    <p>Start building your video library by uploading a new video.</p>
    <button mat-raised-button color="primary" (click)="createNew()">
      <mat-icon>add_circle</mat-icon>
      Upload Video
    </button>
  </div>

  <div class="empty-state" *ngIf="!loading && pagedVideos.length === 0 && searchQuery">
    <mat-icon class="empty-icon">search_off</mat-icon>
    <h2>No results found</h2>
    <p>No videos match "{{searchQuery}}"</p>
    <button mat-raised-button color="primary" (click)="clearSearch()">
      <mat-icon>clear</mat-icon>
      Clear Search
    </button>
  </div>
</div>
