<div class="dialog-container">
  <div class="dialog-header">
    <h1>{{isEditMode ? 'Edit User' : 'Create User'}}</h1>
  </div>

  <div class="dialog-content">
    <form [formGroup]="userForm" class="create-form">
      <div class="form-section">
        <h2 class="section-title">
          <mat-icon>person</mat-icon>
          {{isEditMode ? 'Edit Information' : 'User Information'}}
        </h2>

        <div class="form-grid">
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Full Name</mat-label>
            <input matInput formControlName="fullName" placeholder="Enter full name">
            <mat-icon matPrefix>badge</mat-icon>
            <mat-error *ngIf="userForm.get('fullName')?.hasError('required')">Full name is required</mat-error>
          </mat-form-field>

          <ng-container *ngIf="!isEditMode">
            <mat-form-field appearance="outline" class="full-width">
              <mat-label>Email</mat-label>
              <input matInput formControlName="email" placeholder="Enter email">
              <mat-icon matPrefix>email</mat-icon>
              <mat-error *ngIf="userForm.get('email')?.hasError('required')">Email is required</mat-error>
              <mat-error *ngIf="userForm.get('email')?.hasError('email')">Please enter a valid email address</mat-error>
            </mat-form-field>
          </ng-container>

          <ng-container *ngIf="!isEditMode">
            <mat-form-field appearance="outline" class="full-width">
              <mat-label>Password</mat-label>
              <input matInput formControlName="password" placeholder="Enter password"
                [type]="hidePassword ? 'password' : 'text'">
              <mat-icon matPrefix>lock</mat-icon>
              <button mat-icon-button matSuffix type="button" (click)="hidePassword = !hidePassword" tabindex="-1">
                <mat-icon>{{hidePassword ? 'visibility_off' : 'visibility'}}</mat-icon>
              </button>
              <mat-error *ngIf="userForm.get('password')?.hasError('required')">Password is required</mat-error>
              <mat-error *ngIf="userForm.get('password')?.hasError('minlength')">Password must be at least 6
                characters</mat-error>
            </mat-form-field>
          </ng-container>

          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Role</mat-label>
            <mat-select formControlName="role">
              <mat-option value="USER">User</mat-option>
              <mat-option value="ADMIN">Admin</mat-option>
            </mat-select>
            <mat-icon matPrefix>admin_panel_settings</mat-icon>
          </mat-form-field>
        </div>
      </div>
    </form>
  </div>

  <div class="dialog-footer">
    <button mat-button (click)="onCancel()" class="footer-cancel">Cancel</button>
    <button mat-raised-button color="primary" (click)="onSave()" [disabled]="!userForm.valid|| creating"
      class="footer-save">
      <mat-icon>{{creating ? 'hourglass_empty': (isEditMode ? 'save': 'person_add')}}</mat-icon>
      {{creating ? (isEditMode ? 'Saving...' : 'Creating...') : (isEditMode ? 'Save Changes' : 'Create User')}}
    </button>
  </div>
</div>
